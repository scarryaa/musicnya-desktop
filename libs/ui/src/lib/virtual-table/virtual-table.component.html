<table
  cdk-table
  cdkDropList
  id="media-table"
  [cdkDropListConnectedTo]="['user-playlists']"
  [trackBy]="trackBy"
  [dataSource]="dataSource"
>
  <!-- # Column -->
  <ng-container cdkColumnDef="#">
    <th id="id-table-header" cdk-header-cell *cdkHeaderCellDef>#</th>
    <td class="id-content" cdk-cell *cdkCellDef="let song; let i = index">
      <div>{{ i + 1 }}</div>
      <div id="play-button-container">
        <div id="play-button">
          <svg id="play" viewBox="0 0 24 24">
            <path
              (click)="handleClick($event)"
              id="play-icon"
              d="M8,5.14V19.14L19,12.14L8,5.14Z"
              fill="black"
              stroke="none"
              transform="translate(0, 0)"
            ></path>
          </svg>
        </div>
      </div>
    </td>
  </ng-container>

  <!-- Title Column -->
  <ng-container cdkColumnDef="Title">
    <th id="title-table-header" cdk-header-cell *cdkHeaderCellDef>Title</th>
    <td
      class="title-content"
      [ngClass]="{
        'hide-before': song?.attributes?.contentRating !== 'explicit',
        'hide-after': song?.type !== 'music-videos'
      }"
      cdk-cell
      *cdkCellDef="let song"
    >
      <ui-album-tile
        [artists]="song.attributes?.artistName"
        [showArtists]="true"
        [mediaTitle]="song.attributes?.name"
        [source]="song.attributes?.artwork?.url"
        [tileSize]="2.5"
        [showArt]="showAlbums"
        [ngClass]="{ 'artist-hover': true, 'title-hover': showAlbums }"
      ></ui-album-tile>
      <div id="title-info-container"></div>
    </td>
  </ng-container>

  <!-- Album Column -->
  <ng-container cdkColumnDef="Album">
    <th id="album-table-header" cdk-header-cell *cdkHeaderCellDef>Album</th>
    <td class="album-content" cdk-cell *cdkCellDef="let song">
      <span
        *ngIf="showAlbums"
        [routerLink]="
          '/media/albums/' + (song.relationships?.albums?.data?.[0]?.id || song.relationships?.catalog?.data?.[0]?.relationships?.albums?.data?.[0]?.id)
        "
        [title]="song.attributes?.albumName"
        >{{ song.attributes?.albumName }}</span
      >
    </td>
  </ng-container>

  <!-- Duration Column -->
  <ng-container cdkColumnDef="Duration">
    <th id="duration-table-header" cdk-header-cell *cdkHeaderCellDef>
      <i class="material-symbols-outlined">schedule</i>
    </th>
    <td class="duration-content" cdk-cell *cdkCellDef="let song">
      <div id="duration-options-container">
        <div id="like-button-container">
          <div id="like-button">
            <svg id="like-button" viewBox="0 -960 960 960">
              <path
                (click)="handleClick($event)"
                style="
                  fill: white;
                  fill-opacity: 0;
                  fill-rule: nonzero;
                  stroke: currentColor;
                  stroke-width: 70;
                  stroke-dasharray: none;
                  stroke-opacity: 1;
                "
                d="m 439,-156 -53,-49 C 303.33333,-281.66667 231.66667,-354.83333 171,-424.5 110.33333,-494.16667 80,-567 80,-643 c 0,-60 20.16667,-110.16667 60.5,-150.5 40.33333,-40.33333 90.16667,-60.5 149.5,-60.5 34,0 67.66667,8.16667 101,24.5 18.22546,8.93047 35.35477,20.99993 51.38793,36.20838 13.29057,12.60693 17.00926,29.23973 37.61207,28.40068 22.84194,-0.93024 28.47972,-17.62658 43.06734,-30.73386 15.70871,-14.1146 31.68626,-25.40633 47.93266,-33.8752 31.33333,-16.33333 64.33333,-24.5 99,-24.5 59.33333,0 109.16667,20.16667 149.5,60.5 40.33333,40.33333 60.5,90.5 60.5,150.5 0,76 -30.33333,148.83333 -91,218.5 -60.66667,69.66667 -132.33333,142.83333 -215,219.5 l -53,49 c -11.33333,10.66667 -25,16 -41,16 -16,0 -29.66667,-5.33333 -41,-16 z"
              />
            </svg>
          </div>
        </div>
        <span>{{ song.attributes?.durationInMillis | date : 'm:ss' }}</span>
        <div id="options-button-container">
          <div id="options-button">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 32 24"
              (click)="handleClick($event)"
            >
              <g stroke="currentColor" fill="currentColor" stroke-width="3">
                <circle cx="4" cy="12" r="2" />
                <circle cx="16" cy="12" r="2" />
                <circle cx="28" cy="12" r="2" />
              </g>
            </svg>
          </div>
        </div>
      </div>
    </td>
  </ng-container>

  <tr cdk-header-row *cdkHeaderRowDef="displayedColumns"></tr>
  <tr
    cdk-row
    cdkDrag
    (cdkDragStarted)="onDragStart($event)"
    #mediaItem
    [cdkDragData]="row"
    *cdkRowDef="let row; let i = index; columns: displayedColumns"
    (click)="clickEmitter.emit(i)"
    [ngClass]="{ selected: selected.isSelected(i) }"
  >
    <div id="drag-placeholder" *cdkDragPlaceholder></div>
    <div *cdkDragPreview class="tooltip">
      {{ dragData.title + ', ' + dragData.artists }}
    </div>
  </tr>
</table>
