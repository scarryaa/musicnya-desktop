<ng-container *ngrxLet="state$ as media">
  <div
    *ngIf="media.loaded"
    id="page-wrapper"
    [style.background]="
      'linear-gradient(transparent 14.09rem, transparent 10rem)'
    "
  >
    <div id="media-details-wrapper">
      <ui-album-tile-large
        id="media-cover-artwork"
        #mediaCover
        [imageSource]="media?.currentMedia?.artwork?.url"
        [showPlayButton]="false"
        [tileSize]="12"
        [showInfo]="false"
      ></ui-album-tile-large>
      <div id="media-details">
        <div id="media-text">
          <div id="media-title">{{ media?.currentMedia?.title }}</div>
          <div id="media-artist-year">
            <span
              *ngIf="
                (media?.currentMedia?.type === 'library-playlist' &&
                  media.currentMedia.curator) ||
                (media.currentMedia?.type !== 'library-playlist' &&
                  media?.currentMedia?.curator) ||
                media?.currentMedia?.artists
              "
              >{{
                media?.currentMedia.type === 'library-playlist'
                  ? media?.currentMedia?.curator
                  : media?.currentMedia?.artists ?? 'Unknown Artist'
              }}</span
            ><span *ngIf="media.currentMedia?.releaseYear"
              ><span class="seperator"> â€¢ </span>
              <span id="year">{{
                media?.currentMedia?.releaseYear
              }}</span></span
            >
          </div>
        </div>
        <div id="media-buttons">
          <div id="media-buttons-wrapper">
            <core-base-button
              id="play-button"
              class="core-base-button-filled media-action-button outline-offset-small"
              componentStyleClass="ui-button-l media-action-button"
              text="Play"
              icon="play_arrow"
            ></core-base-button>
            <core-base-button
              id="shuffle-button"
              class="core-base-button-filled media-action-button outline-offset-small"
              componentStyleClass="ui-button-l media-action-button"
              text="Shuffle"
              icon="shuffle"
            ></core-base-button>
          </div>
          <div id="misc-media-buttons">
            <core-base-button
              id="library-add-button"
              class="media-action-button outline-offset-small"
              componentStyleClass="ui-button-l media-action-button"
              icon="arrow_circle_down"
            ></core-base-button>
            <core-base-button
              id="media-options-button"
              class="media-action-button outline-offset-small"
              componentStyleClass="ui-button-l media-action-button"
              icon="more_horiz"
            ></core-base-button>
          </div>
        </div>
      </div>
    </div>
    <div class="more-info">
      <div class="color-div"></div>
      <i
        id="toggle-button"
        class="material-symbols-rounded"
        [ngClass]="{
          rotated: showAdditionalInfo
        }"
        (click)="toggleShowContent()"
        (keydown)="toggleShowContent()"
        >expand_circle_down</i
      >
      <div class="info-border"></div>
      <ui-media-details-dropdown [showContent]="showAdditionalInfo">
        <div id="dropdown-content-wrapper">
          <div class="dropdown-content" #content>
            <div class="content-wrapper">
              <div id="media-songs-genre-description">
                <span id="songs-count"
                  >{{ media?.currentMedia?.songs?.length }} songs,
                </span>
                <span>{{ media?.currentMedia?.duration | date : 'm:ss' }}</span>
                <p *ngIf="media?.currentMedia?.genres" id="genres">
                  <!-- replace this with a pipe -->
                  {{ media?.currentMedia?.genres.join(', ') }}
                </p>
                <p
                  *ngIf="
                    media?.currentMedia?.description ||
                    media.currentMedia?.shortDescription
                  "
                  id="media-description"
                  [innerHTML]="media.currentMedia?.description"
                ></p>
              </div>
            </div>
          </div>
        </div>
      </ui-media-details-dropdown>
    </div>

    <div id="media-content-wrapper">
      <div id="media-content">
        <ui-virtual-table
          [mediaType]="media?.currentMediaType"
          [data]="media?.currentMedia?.songs"
        ></ui-virtual-table>
      </div>
    </div>
  </div>
</ng-container>
